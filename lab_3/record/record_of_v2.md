# 第一项实验

## IP 地址规划与 VLan 分配实验

### 基本内容1

1. 设置主机的`ip`，网关路由器的`ip`

2. 路由器的不同接口的`ip`与其对应的子网中主机的网关路由器相同

### 基本内容2

1. 对于主机，直接配置`ip`地址，以及网管路由器的`ip`
2. 对于交换机，添加`vlan database`，分别添加2,3,4号`vlan`，并将与主机相连的接口设置为对应的`vlan`，与其他交换机或路由器相连的接口设置为`trunk`模式
3. 对于路由器，将所有接口的`ip`设置为空，再通过`int`命令创建子接口，配置子接口的`vlan`以及`ip`，其中`ip`要与1中主机的网关路由器的`ip`相同

# 第二项实验

## 路由配置实验

### 基本内容1

1. 对于主机，直接设置`ip`以及网关路由器`ip`
2. 对于路由器的`Fa`端口，设置`ip`与1中对应
3. 对于路由器的串口，设置`ip`为`192.168.x.a`其中`x`从网络中未使用的最小数字开始(此处为`5`)，依次增加，两个路由器之间的`x`相同，`a`自增，如`router1`和`ronter2`之间的串口分别为`192.168.5.1`和`192.168.5.2`，而`router2`和`router3`之间的串口分别为`192.168.6.1`和`192.168.6.2`
4. 对于路由器的`RIP`算法设置，添加网络为所有的端口所在的子网，如`router1`的`Fa`连接了子网`192.168.1.0/24`,串口连接了`192.168.5.2`（即`router2`），则需要添加`192.168.1.0`以及`192.168.5.0`

### 基本内容2

1. 对于主机直接设置`ip`以及网关路由器`ip`
2. 对于路由器同上
3. 按照pdf中给出的例子，配置`OSPF`即可，其中配置的网段与`基本内容1`中类似

### 基本内容3

> 在`基本内容1`的基础上进行

重点在于弄懂`access-list`以及对`interface`设置`ip access-group`的意义

普通模式的`aceess-list`有两种，限制访问和允许访问，限制的都为`source ip`，即报文的**源ip**

拓展模式的`access-list`也有基本的限制和允许访问两种，但是可以结合流量类型进行筛选，并且可以同时筛选源ip以及目的ip

`ip access-group`两种，`in`和`out`，分别为`inbound`和`outgoing`，前者表示从该端口**进入路由器的流量**，后者表示从该端口**流出路由器的流量**

* 第一部分
  
  * `access-list 10`为`deny any`设置为`outgoing`表示所有从其他的`PC`发送的请求，试图从该接口**出去**的时候，将会被阻断，也即其他`PC`无法访问`PC1`
  * `access-list 11`为`deny 192.168.1.1 0.0.0.255` 设置为`inbound`表示`PC1`的所有试图**进入**该接口的请求都会被阻断

* 第二部分，`access-list 10`为`deny 192.168.2.1 0.0.0.255`设置为`outgoing`表示`PC2`无法访问`PC1`

* 上述所有的`access-list`均需要在最后加上一句`permit any`或`permit ip any any`，否则将屏蔽所有的网段

# 综合部分

1. 首先进行`ip`地址块的划分
   
   学生宿舍1: `211.69.4.0/24` 分配256个
   
   学生宿舍2: `211.69.5.0/24` 分配256个
   
   学生宿舍3: `211.69.6.0/24` 分配256个
   
   图书馆: `211.69.7.0/25` 分配128个  网关`211.69.7.126` /`255.255.255.128`

   学院1: `211.69.7.128/27`分配32个  网关`211.69.7.158`  / `255.255.255.224`

   学院2: `211.69.7.160/27`分配32个 网关`211.69.7.190`/ 同上

   学院3:`211.69.7.192/27`分配32个  网关`211.69.7.222`

   学院4: `211.69.7.224/27`分配32个 网关`211.69.7.254`

2. 全部使用`OSPF`而不是`RIP`

## 使用单一路由器

> 经[colinaaa](https://github.com/colinaaa)指出，该部分可以进行大幅简化，具体请查看对应[issue](https://github.com/HUSTERGS/Computer_Network/issues/1)

### 第一个宿舍

`101` dorm-1-in 

* `access-list 101 deny ip 211.69.4.0 0.0.0.255 211.69.7.128 0.0.0.127`
* `access-list 101 deny ip 211.69.4.0 0.0.0.255 211.69.7.160 0.0.0.127`
* `access-list 101 deny ip 211.69.4.0 0.0.0.255 211.69.7.192 0.0.0.127`
* `access-list 101 deny ip 211.69.4.0 0.0.0.255 211.69.7.224 0.0.0.127`
* `access-list 101 permit ip any any`

`102` dorm-1-out

* `access-list 102 deny ip 211.69.7.128 0.0.0.127 211.69.4.0 0.0.0.255 `

* `access-list 102 deny ip 211.69.7.160 0.0.0.127 211.69.4.0 0.0.0.255`

* `access-list 102 deny ip 211.69.7.192 0.0.0.127 211.69.4.0 0.0.0.255`

* `access-list 102 deny ip 211.69.7.224 0.0.0.127 211.69.4.0 0.0.0.255`

* `access-list 102 permit ip any any`

### 第二个宿舍

`103` dorm-2-in

* `access-list 103 deny ip 211.69.5.0 0.0.0.255 211.69.7.128 0.0.0.127`
* `access-list 103 deny ip 211.69.5.0 0.0.0.255 211.69.7.160 0.0.0.127`
* `access-list 103 deny ip 211.69.5.0 0.0.0.255 211.69.7.192 0.0.0.127`
* `access-list 103 deny ip 211.69.5.0 0.0.0.255 211.69.7.224 0.0.0.127`
* `access-list 103 permit ip any any`

`104` dorm-2-out

* `access-list 104 deny ip 211.69.7.128 0.0.0.127 211.69.5.0 0.0.0.255 `

* `access-list 104 deny ip 211.69.7.160 0.0.0.127 211.69.5.0 0.0.0.255`

* `access-list 104 deny ip 211.69.7.192 0.0.0.127 211.69.5.0 0.0.0.255`

* `access-list 104 deny ip 211.69.7.224 0.0.0.127 211.69.5.0 0.0.0.255`

* `access-list 104 permit ip any any`

### 第三个宿舍

`105` dorm-2-in

* `access-list 105 deny ip 211.69.6.0 0.0.0.255 211.69.7.128 0.0.0.127`
* `access-list 105 deny ip 211.69.6.0 0.0.0.255 211.69.7.160 0.0.0.127`
* `access-list 105 deny ip 211.69.6.0 0.0.0.255 211.69.7.192 0.0.0.127`
* `access-list 105 deny ip 211.69.6.0 0.0.0.255 211.69.7.224 0.0.0.127`
* `access-list 105 permit ip any any`

`106` dorm-2-out

* `access-list 106 deny ip 211.69.7.128 0.0.0.127 211.69.6.0 0.0.0.255 `

* `access-list 106 deny ip 211.69.7.160 0.0.0.127 211.69.6.0 0.0.0.255`

* `access-list 106 deny ip 211.69.7.192 0.0.0.127 211.69.6.0 0.0.0.255`

* `access-list 106 deny ip 211.69.7.224 0.0.0.127 211.69.6.0 0.0.0.255`

* `access-list 106 permit ip any any`

### 学院1

`107` sch-1-in

* `access-list 107 deny ip 211.69.7.128 0.0.0.127 211.69.4.0 0.0.0.255 `
* `access-list 107 deny ip 211.69.7.128 0.0.0.127 211.69.5.0 0.0.0.255 `
* `access-list 107 deny ip 211.69.7.128 0.0.0.127 211.69.6.0 0.0.0.255 `
* `access-list 107 permit ip any any`

`108` sch-1-out

* `access-list 108 deny ip 211.69.4.0 0.0.0.255 211.69.7.128 0.0.0.127`
* `access-list 108 deny ip 211.69.5.0 0.0.0.255 211.69.7.128 0.0.0.127`
* `access-list 108 deny ip 211.69.6.0 0.0.0.255 211.69.7.128 0.0.0.127`
* `access-list 108 permit ip any any`

### 学院2

`109` sch-2-in

* `access-list 109 deny ip 211.69.7.160 0.0.0.127 211.69.4.0 0.0.0.255 `
* `access-list 109 deny ip 211.69.7.160 0.0.0.127 211.69.5.0 0.0.0.255 `
* `access-list 109 deny ip 211.69.7.160 0.0.0.127 211.69.6.0 0.0.0.255 `
* `access-list 109 permit ip any any`

`110` sch-2-out

* `access-list 110 deny ip 211.69.4.0 0.0.0.255 211.69.7.160 0.0.0.127`
* `access-list 110 deny ip 211.69.5.0 0.0.0.255 211.69.7.160 0.0.0.127`
* `access-list 110 deny ip 211.69.6.0 0.0.0.255 211.69.7.160 0.0.0.127`
* `access-list 110 permit ip any any`

### 学院3

`111` sch-3-in

* `access-list 111 deny ip 211.69.7.192 0.0.0.127 211.69.4.0 0.0.0.255 `
* `access-list 111 deny ip 211.69.7.192 0.0.0.127 211.69.5.0 0.0.0.255 `
* `access-list 111 deny ip 211.69.7.192 0.0.0.127 211.69.6.0 0.0.0.255 `
* `access-list 111 permit ip any any`

`112` sch-3-out

* `access-list 112 deny ip 211.69.4.0 0.0.0.255 211.69.7.192 0.0.0.127`
* `access-list 112 deny ip 211.69.5.0 0.0.0.255 211.69.7.192 0.0.0.127`
* `access-list 112 deny ip 211.69.6.0 0.0.0.255 211.69.7.192 0.0.0.127`
* `access-list 112 permit ip any any`

### 学院4

`113` sch-4-in

* `access-list 113 deny ip 211.69.7.224 0.0.0.127 211.69.4.0 0.0.0.255 `
* `access-list 113 deny ip 211.69.7.224 0.0.0.127 211.69.5.0 0.0.0.255 `
* `access-list 113 deny ip 211.69.7.224 0.0.0.127 211.69.6.0 0.0.0.255 `
* `access-list 113 permit ip any any`

`114` sch-4-out

* `access-list 114 deny ip 211.69.4.0 0.0.0.255 211.69.7.224 0.0.0.127`
* `access-list 114 deny ip 211.69.5.0 0.0.0.255 211.69.7.224 0.0.0.127`
* `access-list 114 deny ip 211.69.6.0 0.0.0.255 211.69.7.224 0.0.0.127`
* `access-list 114 permit ip any any`